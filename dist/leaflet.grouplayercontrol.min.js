function GroupLayerDetail(a,b,c,d){var e={Name:a||"",Display:b,Labeled:c,SelectedLayer:d||""};return e}function LayerControlGroup(a,b,c){c=c||[],c.display=c.display||"show",c.label=c.label||"unchecked",c.selectedItemName=c.selectedItemName||"",c.shouldDisplayName=c.shouldDisplayName!==!1,a&&a.constructor===Array||(a=[a]),this.layers=a,this.name=b;for(var e in a)this.layers[e].groupName=b;if(this.setDisplay=function(a){this.displayElement&&(a?(this.displayElement.classList.add("leaflet-control-display-checked"),this.displayElement.classList.remove("leaflet-control-display-unchecked")):(this.displayElement.classList.remove("leaflet-control-display-checked"),this.displayElement.classList.add("leaflet-control-display-unchecked")))},this.getDisplay=function(){return!this.displayElement||this.displayElement.classList.contains("leaflet-control-display-checked")},this.setLabeled=function(a){this.labelElement&&(a?(this.labelElement.classList.add("leaflet-control-label-checked"),this.labelElement.classList.remove("leaflet-control-label-unchecked")):(this.labelElement.classList.remove("leaflet-control-label-checked"),this.labelElement.classList.add("leaflet-control-label-unchecked")))},this.getLabeled=function(){const a=this.labelElement||!1;return!!a&&(!this.labelElement||this.labelElement.classList.contains("leaflet-control-label-checked"))},this.getSelectedLayer=function(){if(1===this.layers.length)return this.layers[0];if(this.selectElement){var a=this.selectElement.options[this.selectElement.selectedIndex].value,b=this._getLayerByName(a);return b}return null},this.setSelectedLayer=function(a){if(this.selectElement){var b=this.layers.indexOf(a);b>=0&&(this.selectElement.options[b].selected=!0)}},"hide"!==c.display&&(this.displayElement=document.createElement("div"),this.displayElement.LayerControlAction=LayerControlAction.ToggleDisplay,this.displayElement.groupName=this.name,this.setDisplay(!1)),"hide"!==c.label&&(this.labelElement=document.createElement("div"),this.labelElement.LayerControlAction=LayerControlAction.ToggleLabels,this.labelElement.groupName=this.name,this.setLabeled("checked"===c.label)),this.nameElement=document.createElement("span"),this.nameElement.innerHTML=" "+(c.shouldDisplayName===!0?this.name:""),this.nameElement.groupName=this.name,a&&a.constructor===Array&&a.length>1){for(var f='<select class="leaflet-control-layers-selector-'+b+'" onmouseout="if (arguments[0]) {arguments[0].stopPropagation();} else {window.event.cancelBubble();}">',e=0;e<this.layers.length;e++){var g=this.layers[e],b=g.options.name,h=c.selectedItemName===g.options.labelSource?"selected":"";f+="<option "+h+' value="'+b+'">'+b+"</option>"}f+="</select>";var i=document.createElement("div");i.innerHTML=f,i.firstChild.LayerControlAction=LayerControlAction.SelectLayer,i.firstChild.groupName=this.name,this.selectElement=i.firstChild}this._getLayerByName=function(a){var b=this.layers.filter(function(b){return b.options.name===a});return b.length>0?b[0]:null},this._anyLayerVisible=function(a){return this.layers.filter(function(b){return a.hasLayer(b)}).length>0},this.init=function(a){var b=this.layers.filter(function(b){return a.hasLayer(b)});this.setDisplay(b.length>0),b.length>0&&this.setSelectedLayer(b[0])}}var LayerControlAction={ToggleDisplay:1,ToggleLabels:2,SelectLayer:3};L.Control.GroupedLayers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,labelCallback:null},initialize:function(a,b){var c,d,e;L.Util.setOptions(this,b),this._layers={},this._groups=a,this._lastZIndex=0,this._handlingClick=!1;for(c in this._groups){e=this._groups[c];for(d in e.layers)this._addLayer(e.layers[d])}},_getGroupByName:function(a){var b=this._groups.filter(function(b){return b.name===a});return b.length>0?b[0]:null},_addLayer:function(a){var b=L.Util.stamp(a);this._layers[b]=a,this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},onAdd:function(a){return this._initLayout(),this._update(),a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},_initLayout:function(){var a="leaflet-control-layers",b=this._container=L.DomUtil.create("div",a);b.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(b,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(b),L.DomEvent.on(b,"wheel",L.DomEvent.stopPropagation));var c=this._form=L.DomUtil.create("form",a+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(b,"mouseover",this._expand,this).on(b,"mouseout",this._collapse,this);var d=this._layersLink=L.DomUtil.create("a",a+"-toggle",b);d.href="#",d.title="Layers",L.Browser.touch?L.DomEvent.on(d,"click",L.DomEvent.stop).on(d,"click",this._expand,this):L.DomEvent.on(d,"focus",this._expand,this),this._map.on("click",this._collapse,this)}else this._expand();this._groupTable=L.DomUtil.create("table",a+"-overlays",c),b.appendChild(c)},_update:function(){if(this._container){this._groupTable.innerHTML="";for(var a in this._groups)this._addGroup(this._groups[a])}},_onLayerChange:function(a){var b=this._layers[L.Util.stamp(a.layer)];if(b){this._handlingClick||this._update();var c=this._getGroupByName(b.groupName),d=c&&!c.displayElement,e=d?"layeradd"===a.type?"baselayerchange":null:"layeradd"===a.type?"overlayadd":"overlayremove";e&&this._map.fire(e,b)}},_addGroup:function(a){a.init(this._map);var b,c;return b=document.createElement("tr"),c=document.createElement("td"),a.displayElement?(L.DomEvent.on(a.displayElement,"click",this._onLayerControlAction,this),c.appendChild(a.displayElement)):c.innerHTML="&nbsp;",b.appendChild(c),c=document.createElement("td"),a.labelElement?(L.DomEvent.on(a.labelElement,"click",this._onLayerControlAction,this),c.appendChild(a.labelElement)):c.innerHTML="&nbsp;",b.appendChild(c),c=document.createElement("td"),c.appendChild(a.nameElement),a.selectElement&&(L.DomEvent.on(a.selectElement,"change",this._onLayerControlAction,this),c.appendChild(a.selectElement)),b.appendChild(c),this._groupTable.appendChild(b),b},_onLayerControlAction:function(a){var b,c,d,e,f;switch(this._handlingClick=!0,c=this._getGroupByName(a.currentTarget.groupName),d=c.getSelectedLayer(),a.currentTarget.LayerControlAction){case LayerControlAction.ToggleDisplay:c.setDisplay(!c.getDisplay()),f=c.getDisplay();for(b in c.layers)e=c.layers[b],this._setLayerDisplay(e,e===d&&f);break;case LayerControlAction.ToggleLabels:c.setLabeled(!c.getLabeled()),this.options.labelCallback&&this.options.labelCallback(this._getLabeledLayers(),c);break;case LayerControlAction.SelectLayer:f=c.getDisplay();for(b in c.layers)e=c.layers[b],this._setLayerDisplay(e,e===d&&f);this.options.labelCallback&&c.getLabeled()&&this.options.labelCallback(this._getLabeledLayers(),c)}this._map.fire("layercontrolchange",{group:c,layer:d,action:a.currentTarget.LayerControlAction}),this._handlingClick=!1},_setLayerDisplay:function(a,b){var c=this._map.hasLayer(a);c!==b&&(b?this._map.addLayer(a):this._map.removeLayer(a))},_getLabeledLayers:function(){return this._groups.filter(function(a){return a.getLabeled()}).map(function(a){return a.getSelectedLayer()})},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")},_groupSetting:function(a){a=a||{};var b=new GroupLayerDetail(a.name,a.getDisplay(),a.getLabeled(),a.getSelectedLayer());return b},current:function(){const a=this,b=(a._groups||[]).map(function(b){return a._groupSetting(b)})||[];return b}}),L.control.groupedLayers=function(a,b){return new L.Control.GroupedLayers(a,b)};